apply plugin: 'war'

sourceCompatibility = '1.8'
targetCompatibility = '1.8'

compileJava.options.encoding = 'UTF-8'

repositories {
    mavenCentral()
}

dependencies {
    providedCompile 'fish.payara.extras:payara-micro:4.1.1.163'
}

war.baseName = 'test'

task run(type: Exec, dependsOn: war) {
    def payaraJarPath = configurations
                          .providedCompile
                          .find {it.name =~ /payara-micro.*\.jar/}
                          .absolutePath
    def warFile = war.archivePath

    commandLine('java', '-jar', payaraJarPath, '--deploy', warFile)
}
